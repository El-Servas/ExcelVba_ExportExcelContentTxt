Representación Textual del archivo de Excel: "PersonalMacroFileExample.xls"

Hojas:
 [Sheet1]

Contenido:
[Sheet1]

Nombres:

Nombre del proyecto VB: [VBAProject]

Módulos VBA:
 [ThisWorkbook] Tipo: 100
 [Sheet1] Tipo: 100
 [MyLibs] Tipo: 1
 [BookLoader] Tipo: 1

Codigo:
[ThisWorkbook] 6 líneas de código.
///--- BEGINNING OF MODULE ---
Option Explicit

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
MyLibs.ExportToTxt Me
End Sub

\\\--- END OF MODULE ---

[Sheet1] 2 líneas de código.
///--- BEGINNING OF MODULE ---
Option Explicit

\\\--- END OF MODULE ---

[MyLibs] 23 líneas de código.
///--- BEGINNING OF MODULE ---
Option Explicit

'Ejemplo de la rutina (Y el módulo) que debe de estar presente en el Archivo de Macros Personales para correr la funcionalidad.
Public Sub ExportToTxt(book As Workbook)
On Error GoTo ExportToTxt_Error

    BookLoader.OpenBook "..\ExportToTxt.xls"
    
    Application.Run "ExportToTxt.xls!ExportToTxt.ExportToTxt", book
    
    BookLoader.CloseBook

On Error GoTo 0
Exit Sub

ExportToTxt_Error:
    Debug.Print "*** Ocurrió un error en la rutina ExportToTxt.ExportToTxt"
    Debug.Print "*** Error No: " & Err.Number & ". " & Err.Description
    If Err.Number = 1004 Then 'Cachamos el error de apertura del archivo.
    Else 'Cachamos el resto de los errores. Asumimos que se abrió el archivo y el error fue en la llamada de Application.Run
        BookLoader.CloseBook
    End If
End Sub
\\\--- END OF MODULE ---

[BookLoader] 14 líneas de código.
///--- BEGINNING OF MODULE ---
Option Explicit

Private SummonedBook As Workbook

Public Sub OpenBook(bookFilenameRelativePath As String)
    Dim CurrentActiveBook As Workbook: Set CurrentActiveBook = ActiveWorkbook
    Set SummonedBook = Workbooks.Open(ThisWorkbook.Path & "\" & bookFilenameRelativePath)
    CurrentActiveBook.Activate
End Sub

Public Sub CloseBook()
    SummonedBook.Close False
    Set SummonedBook = Nothing
End Sub
\\\--- END OF MODULE ---


